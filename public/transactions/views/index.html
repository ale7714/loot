<table id="transactions" class="table table-striped table-bordered table-hover table-condensed" og-table-navigable="tableActions">
	<thead id="transactions-header" ng-switch="account.account_type">
		<tr ng-switch-when="investment">
			<th class="transaction-date">Date</th>
			<th class="details">Details</th>
			<th class="amount">Quantity</th>
			<th class="amount">Price</th>
			<th class="amount">Total</th>
		</tr>
		<tr ng-switch-default>
			<th class="transaction-date">Date</th>
			<th class="details">Details</th>
			<th class="amount">Debit</th>
			<th class="amount">Credit</th>
			<th class="amount">Balance</th>
		</tr>
		<tr>
			<td colspan="5">
				<button class="btn btn-primary" ng-click="getTransactions('prev')">Previous</button>
				<span>{{firstTransactionDate | date:"dd/MM/yyyy"}} - {{lastTransactionDate | date:"dd/MM/yyyy"}}</span>
			</td>
		</tr>
		<tr og-table-loading="loading['prev']" colspan="5"></tr>
	</thead>
	<tbody>
		<tr class="transaction" ng-repeat="transaction in transactions" ng-switch="account.account_type">
			<td>{{transaction.transaction_date | date:'dd/MM/yyyy'}}</td>
			<td class="details">
				<table class="table-condensed">
					<tr>
						<td ng-if="transaction.payee.id" colspan="2">{{transaction.payee.name}}</td>
						<td ng-if="transaction.security.id" colspan="2">{{transaction.security.name}}</td>
					</tr>
					<tr>
						<td class="category">{{transaction.category.name}}</td>
						<td ng-if="transaction.transaction_type == 'Basic'" class="category">{{transaction.subcategory.name}}</td>
						<td ng-if="['Transfer', 'Subtransfer', 'SecurityTransfer', 'Dividend', 'SecurityInvestment'].indexOf(transaction.transaction_type) != -1" class="category">{{transaction.account.name}}</td>
						<td ng-if="['Split', 'LoanRepayment', 'Payslip'].indexOf(transaction.transaction_type) != -1">
							<button ng-click="toggleSubtransactions($event, transaction)" class="btn btn-xs btn-default toggle-subtransactions">
								<i class="glyphicon" ng-class="{'glyphicon-chevron-down': !transaction.showSubtransactions, 'glyphicon-chevron-up': transaction.showSubtransactions}"></i>
							</button>
						</td>
					</tr>
					<tr ng-if="['Split', 'LoanRepayment', 'Payslip'].indexOf(transaction.transaction_type) != -1" ng-show="transaction.showSubtransactions">
						<td colspan="2">
							<table class="table-condensed">
								<thead>
									<tr>
										<th>Category</th>
										<th>Subcategory</th>
										<th>Description</th>
										<th class="amount">Amount</th>
									</tr>
									<tr og-table-loading="transaction.loadingSubtransactions" colspan="4"></tr>
								</thead>
								<tbody>
									<tr ng-repeat="subtransaction in transaction.subtransactions">
										<td>{{subtransaction.category.name}}</td>
										<td ng-if="subtransaction.transaction_type == 'Basic'">{{subtransaction.subcategory.name}}</td>
										<td ng-if="subtransaction.transaction_type == 'Subtransfer'">{{subtransaction.account.name}}</td>
										<td>{{subtransaction.memo}}</td>
										<td class="amount" ng-class="{'text-danger': (subtransaction.amount * (subtransaction.direction == transaction.direction ? 1 : -1)) < 0}">{{subtransaction.amount * (subtransaction.direction == transaction.direction ? 1 : -1) | currency}}</td>
									</tr>
								</tbody>
							</table>
						</td>
					</tr>
					<tr>
						<td class="memo" colspan="2">
							<span>{{transaction.memo}}</span>
							<span ng-if="(!transaction.memo) && transaction.transaction_type == 'SecurityInvestment'">{{transaction.quantity | number}} @ ${{transaction.price | number:3}} <span ng-if="transaction.commission">(less {{transaction.commission | currency}} commission)</span></span>
						</td>
					</tr>
				</table>
			</td>
			<td class="amount details">
				<span ng-switch-default ng-if="transaction.direction == 'outflow'" ng-class="{'text-danger': transaction.amount < 0}">{{transaction.amount | currency}}</span>
				<table class="table-condensed" ng-switch-when="investment">
					<tr>
						<td>{{transaction.quantity | number}}</td>
					</tr>
					<tr ng-if="transaction.transaction_type == 'SecurityInvestment'">
						<td><em>Commission:</em></td>
					</tr>
				</table>
			</td>
			<td class="amount details">
				<span ng-switch-default ng-if="transaction.direction == 'inflow'" ng-class="{'text-danger': transaction.amount < 0}">{{transaction.amount | currency}}</span>
				<table class="table-condensed" ng-switch-when="investment" ng-if="transaction.transaction_type == 'SecurityInvestment'">
					<tr>
						<td>${{transaction.price | number}}</td>
					</tr>
					<tr>
						<td>{{transaction.commission | currency}}</td>
					</tr>
				</table>
			</td>
			<td class="amount">
				<span ng-switch-default ng-class="{'text-danger': transaction.balance < 0}">{{transaction.balance | currency}}</span>
				<span ng-switch-when="investment" ng-if="transaction.transaction_type == 'SecurityInvestment'">{{transaction.quantity * transaction.price - transaction.commission | currency}}</span>
				<span ng-switch-when="investment" ng-if="transaction.transaction_type == 'Dividend'">{{transaction.amount | currency}}</span>
			</td>
		</tr>
	</tbody>
	<tfoot>
		<tr>
			<td colspan="5">
				<button class="btn btn-primary" ng-click="getTransactions('next')">Next</button>
				<span>{{firstTransactionDate | date:"dd/MM/yyyy"}} - {{lastTransactionDate | date:"dd/MM/yyyy"}}</span>
			</td>
		</tr>
		<tr og-table-loading="loading['next']" colspan="5"></tr>
	</tfoot>
</table>
